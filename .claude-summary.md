# VoxFlame Agent - 项目概述

> **燃言 - Ignite Your Voice**
>
> 专为2000万构音障碍者打造的AI语音转换助手

## 项目本质

**不是"纠正"用户的表达，而是"理解"用户的意图，让每个声音都被听见。**

**核心流程**：用户说话 → ASR识别 → LLM纠错 → 清晰字幕 + TTS语音输出

---

## 技术栈

| 层级 | 技术 | 端口 | 说明 |
|------|------|------|------|
| 前端 | Next.js 14 + TypeScript + TailwindCSS + PWA | 3000 | Google风格简洁UI |
| 后端 | Express + TypeScript + WebSocket Proxy | 3001 | API + WS代理 |
| Agent | TEN Framework (Go Runtime + Python Extensions) | 8766 | ASR→LLM→TTS流水线 |
| ASR | 阿里云 funasr-nano (Paraformer-realtime-v2) | - | 容忍模糊识别 |
| LLM | QWEN3 Max via DashScope | - | 上下文推断纠错 |
| TTS | CosyVoice v3 (longxiaochun) | - | 温暖亲切音色 |
| 向量库 | Qdrant (可选) | 6333 | 记忆系统 |

---

## 目录结构

```
VoxFlame-Agent/
├── frontend/              # Next.js PWA 应用
│   ├── src/app/           # 页面 (ranyan/contribute)
│   ├── src/hooks/         # useAgent WebSocket hook
│   └── src/lib/           # 音频处理、WS客户端
├── backend/               # Express 服务器
│   └── src/index.ts       # HTTP API + WS代理到ten-agent
├── ten_agent/             # TEN Framework Agent
│   ├── extension_src/     # Python扩展
│   │   ├── voxflame_main_python/      # 主扩展
│   │   ├── websocket_server/          # WebSocket服务器
│   │   └── llm_correction_python/     # LLM纠错扩展
│   ├── manifest.json      # Agent配置
│   └── property.json      # 运行时参数
├── docs/                  # 技术文档
│   ├── TEN_*.md           # TEN框架研究
│   ├── LLM_CORRECTION_*.md # LLM纠错计划
│   └── PWA_*.md           # PWA实施指南
├── docker-compose.yml     # 容器编排
└── .env                   # 环境变量 (DASHSCOPE_API_KEY)
```

---

## 关键参数（构音障碍特异性）

| 模块 | 参数 | 推荐值 | 说明 |
|------|------|--------|------|
| VAD | threshold | 0.3-0.4 | 降低误触发（正常0.5） |
| VAD | silence_duration | 1500-2000ms | 延长等待（正常1000ms） |
| LLM | temperature | 0.3 | 降低随机性 |
| LLM | max_tokens | 100 | 限制输出长度 |
| TTS | voice | longxiaochun | 温暖亲切 |
| TTS | speed | 0.9 | 略微放慢 |

---

## 当前状态

### v1.0 - 基础语音助手 ✅
- TEN Framework集成
- 阿里云ASR实时识别
- 通义千问LLM对话
- CosyVoice TTS语音
- WebSocket实时通信
- PWA基础支持
- Docker部署

### v1.1 - WebSocket代理 ✅
- 后端代理WS请求到TEN Agent
- 解决VSCode Remote SSH端口转发问题

### v1.2 - UI改进 ✅
- Google风格简洁界面
- 点击式录音（空格键控制）
- 字幕实时显示

### v1.3 - 用户认证系统 ✅
- Supabase Auth 集成
- 注册/登录功能
- JWT Token 认证
- Agent 用户上下文感知

### v1.4 - 环境配置修复 ✅
- Docker Compose 构建参数修复
- NEXT_PUBLIC_* 环境变量正确传递
- 前端动态 URL 配置
- 完整消息链路验证通过

### v2.0 - 构音障碍适配 🚧
- [ ] Phase 1: VAD 参数优化 (P0)
- [ ] Phase 2: LLM 纠错 Prompt 优化 (P0)
- [ ] Phase 3: 音频流稳定性提升 (P1)
- [ ] Phase 4: TTS 音色选择 (P1)
- [ ] Phase 5: 个性化纠错 (P2)

**详细计划**: [docs/LLM_CORRECTION_DEVELOPMENT_PLAN.md](docs/LLM_CORRECTION_DEVELOPMENT_PLAN.md)

---

## 快速命令

### Docker管理
```bash
sudo docker-compose ps                  # 查看状态
sudo docker-compose logs -f             # 查看日志
sudo docker-compose restart <service>   # 重启服务
sudo docker-compose up -d --build       # 重新构建启动
```

### 服务访问
- 前端: http://localhost:3000
- 后端: http://localhost:3001
- TEN Agent: ws://localhost:8766

### 测试
```bash
cd frontend && npm test          # 前端测试
cd backend && npm test           # 后端测试
pytest                           # Python测试
```

---

## 工作日志

### 2025-01-23
- 重构AI编程指导体系
- 建立哲学化文档系统
- 简化工具使用规则

---

## 研究资料

### 论文
- [Bridging ASR and LLMs for Dysarthric Speech Recognition](https://arxiv.org/abs/2508.08027) - Interspeech 2025
- [Zero-shot MLLM for Dysarthric ASR](https://arxiv.org/abs/2406.00639) - Interspeech 2024
- [Generative Error Correction with LLMs](https://arxiv.org/abs/2409.09554) - 2024

### 相关项目
- [TEN-Agent](https://github.com/TEN-framework/TEN-Agent) - 实时语音Agent框架
- [CLEAR-VOX-MODEL](https://github.com/AIden-QiU1/CLEAR-VOX-MODEL) - 构音障碍语音研究

---

## 开发原则

1. **可理解性优先于准确性** - 容忍模糊，理解意图
2. **实践驱动** - 不过度设计，每步来自真实需求
3. **渐进增强** - 先可用再好用，最后优秀
4. **工具服务于目标** - 不炫技，不滥用工具

---

**让每个声音都被听见** 🎗️
